# Fish Catcher - Project Guide

## Overview
Fish Catcher is a mobile arcade game targeting **iOS and Android**. The game is live on the App Store.

**Bundle ID:** See `.env` (`BUNDLE_ID`)
**Apple Team ID:** See `.env` (`APPLE_TEAM_ID`)

## Migration Status
This project has been migrated from **Godot 4.6 → Unity**. Multiplayer has been removed. The Godot code in `scripts/` and `scenes/` remains as reference. The Unity project is in `FishCatcherUnity/`.

## Game Mechanics

### Single Player
- Catch 10 fish to win, starting with 10 seconds on the clock
- Each fish caught adds +2 seconds bonus time
- Touch/click to lower fishing hook, release to grab and raise
- Drag left/right to move hook horizontally
- Fish hang at 90 degrees when hooked
- Drop hooked fish into the bucket to score
- 15 fish spawn in a grid pattern with randomness
- Fish swim across the full screen width, wrapping around edges at new depths
- 16 unique fish species with sprite assets (anglerfish, barracuda, clownfish, etc.)
- Fish respawn when count drops below 5
- Haptic feedback on iOS when a fish is caught

### Screens
- **Home Screen:** Play button, decorative fish swimming below, pulsing title
- **Main Game:** Fishing hook, fish spawner, score/timer, bucket, pause menu

## Project Structure

### Unity Project (`FishCatcherUnity/`)
```
Assets/
  Scripts/
    GameManager.cs          - Game loop, scoring, timer (+2s bonus), pause
    Claw.cs                 - Touch/mouse input, hook mechanics, bucket detection
    Fish.cs                 - Fish swim AI, wrap-around edges, grab/release
    FishSpawner.cs          - Spawn 15 fish, respawn when < 5
    DropZone.cs             - Bucket collision, scoring
    HomeScreen.cs           - Menu, decorative wrap-around fish
    SafeAreaPanel.cs        - iPhone safe area (notch/Dynamic Island) handler
    FloatUpAndFade.cs       - Score popup animation
    FishSpriteGenerator.cs  - Procedural fish sprite (fallback)
  Sprites/
    Fish/                   - 16 fish species PNG assets
    ClawSpriteGenerator.cs  - Procedural hook/bucket sprites
    BackgroundGenerator.cs  - Procedural underwater background sprites
    BubbleAnimator.cs       - Animated rising bubble pool
    ProceduralSetup.cs      - Auto-assigns sprites on prefabs
    Editor/
      SceneBuilder.cs       - One-click scene generation (iOS UI best practices)
  Scenes/                   - Generated by SceneBuilder
  Prefabs/                  - Generated by SceneBuilder
ProjectSettings/            - Unity project config
```

### Godot Reference (`scripts/` and `scenes/`)
```
scenes/          - Godot scene files (.tscn): main, home_screen
scripts/         - GDScript files (.gd): game logic, fish AI
```

## Game Constants
- **Viewport:** 1080 x 1920 reference (portrait, mobile-optimized)
- **Target fish:** 10
- **Starting time:** 10 seconds (+2s per fish caught)

## Build & Deployment
- **Android:** AAB format, package from `.env` (`BUNDLE_ID`), min SDK 21, target SDK 34
- **iOS:** Unity build → Xcode project, deployed via Fastlane
- **CI/CD:** GitHub Actions - push to `main` → TestFlight, git tag `v*` → App Store

## Art Style
- **Pixel art / 8-bit retro** aesthetic throughout
- **Font:** Press Start 2P (Google Fonts) — used for all text via TextMeshPro
- **Icons & sprites:** Created in Midjourney, edited in Figma, exported as PNGs
- All procedural sprites use `FilterMode.Point` (no bilinear smoothing)
- Small textures (8x8 to 128x128) scaled up via transform for chunky pixel look
- Limited color palettes per element (3-5 colors max)
- Underwater background: custom PNG background image + animated bubble overlay
- Button sprites: 4 color variants (Green, Blue, Red, Yellow) loaded from Assets/Sprites/Buttons/
- Static sprite caching with `ClearCache()` pattern for editor rebuilds
- Sorting order layers: background (-10 to -3), gameplay (3-6), UI overlay (10-12)

## Important Unity Gotchas
- **Sprite imports:** Unity imports new PNGs as "Default" texture type — must configure as `TextureImporterType.Sprite` via TextureImporter or they won't render as sprites. SceneBuilder's `ConfigureSpriteImports()` handles this automatically.
- **Fish direction:** Use `spriteRenderer.flipX` for direction flipping, NOT `localScale.x` manipulation (causes visual issues)
- **TMP fonts:** Create TMP font assets from TTF via `TMP_FontAsset.CreateFontAsset()` at editor build time, not runtime
- **Pixel font sizing:** Press Start 2P renders larger than standard fonts — use smaller sizes (title: 72, subtitle: 28, buttons: 42)

## Code Conventions

### Unity (C#)
- **Naming:** PascalCase for classes/methods, camelCase for fields, UPPER_CASE for constants
- **Input:** Support both touch and mouse (Input.GetTouch + Input.GetMouseButton)
- **Collision:** CircleCollider2D/BoxCollider2D triggers, Physics2D.OverlapCircleAll for grab detection
- **Animation:** Coroutines for effects, Mathf.Sin for bobbing
- **State:** Simple enums (ClawState.IDLE/HOLDING)

### iOS UI Conventions
- **Canvas:** 1080x1920 reference, Scale with Screen Size, match height (1)
- **Safe Area:** All UI wrapped in SafeAreaPanel (adjusts for notch/Dynamic Island)
- **Touch targets:** Minimum 120px at reference resolution
- **Layout:** Score/timer at top (non-interactive), actions accessible in thumb zone
- **Padding:** 30px minimum from safe area edges
- **Text:** TextMeshPro only, minimum 24px for labels, 36px+ for readability
- **Panels:** Use CanvasGroup for fade transitions, rounded corners via sliced sprites
- **Haptics:** Handheld.Vibrate() on iOS for fish catches
- **Aspect ratio:** Anchored UI with flexible game view (supports iPhone SE to Pro Max)

### Godot Reference (GDScript)
- **Naming:** snake_case for files, variables, signals; UPPER_CASE for constants
- **Collision:** Area2D with CircleShape2D, signal-based detection
- **Animation:** Tweens for UI, sin wave for fish bobbing

## Unity Setup
See `FishCatcherUnity/SETUP.md` for full setup instructions.
Quick start: Open in Unity > Window > Fish Catcher > Build Scenes > Build All

## Git Conventions
- **No co-author lines** in commit messages — do not add `Co-Authored-By` trailers
- **Run all tests before committing** — always run the test suite before any commit/push
- **Only commit when the user explicitly says to** — do not auto-commit
